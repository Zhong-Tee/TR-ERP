# ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏õ‡∏±‡∏ç‡∏´‡∏≤ HTTP 401 ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏µ‡∏¢‡∏Å Edge Function

## ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà‡∏û‡∏ö

‡∏à‡∏≤‡∏Å Logs ‡∏û‡∏ö‡∏ß‡πà‡∏≤:
- **HTTP 401** ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏µ‡∏¢‡∏Å Edge Function `verify-slip`
- JWT token ‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡∏∞‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á (‡∏à‡∏≤‡∏Å log metadata)
- `expires_at: 1769525156` (timestamp ‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï - ‡∏î‡∏π‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á)
- `role: "authenticated"` - ‡∏°‡∏µ authentication
- ‡πÅ‡∏ï‡πà Edge Function ‡∏¢‡∏±‡∏á return 401

**‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏:** Supabase ‡∏≠‡∏≤‡∏à reject request ‡∏Å‡πà‡∏≠‡∏ô‡∏ñ‡∏∂‡∏á Edge Function code

---

## ‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç

### ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 1: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Edge Function Settings ‡πÉ‡∏ô Dashboard

1. **‡πÄ‡∏Ç‡πâ‡∏≤ Supabase Dashboard:**
   - ‡πÑ‡∏õ‡∏ó‡∏µ‡πà https://supabase.com/dashboard
   - ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå `zkzjbhvsltbwbtteihiy`

2. **‡πÑ‡∏õ‡∏ó‡∏µ‡πà Edge Functions ‚Üí verify-slip ‚Üí Settings:**
   - ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡πÄ‡∏°‡∏ô‡∏π **Edge Functions** ‡∏î‡πâ‡∏≤‡∏ô‡∏ã‡πâ‡∏≤‡∏¢
   - ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà function **verify-slip**
   - ‡∏Ñ‡∏•‡∏¥‡∏Å‡πÅ‡∏ó‡πá‡∏ö **Settings** ‡∏´‡∏£‡∏∑‡∏≠ **Details**

3. **‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Authentication Settings:**
   - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ "Require authentication" ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
   - ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ ‡πÉ‡∏´‡πâ‡∏õ‡∏¥‡∏î (uncheck)
   - ‡∏´‡∏£‡∏∑‡∏≠‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÉ‡∏´‡πâ allow anonymous access

### ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 2: ‡∏•‡∏≠‡∏á Logout ‡πÅ‡∏•‡∏∞ Login ‡πÉ‡∏´‡∏°‡πà

1. **‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö:**
   - ‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡πÅ‡∏≠‡∏õ‡∏û‡∏•‡∏¥‡πÄ‡∏Ñ‡∏ä‡∏±‡∏ô
   - ‡∏Ñ‡∏•‡∏¥‡∏Å "‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö"

2. **‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏´‡∏°‡πà:**
   - Login ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á
   - ‡∏£‡∏≠‡πÉ‡∏´‡πâ session token ‡∏ñ‡∏π‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà

3. **‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á:**
   - ‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤ Settings
   - ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏•‡∏¥‡∏õ

### ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 3: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Session Token

1. **‡πÄ‡∏õ‡∏¥‡∏î Browser DevTools:**
   - ‡∏Å‡∏î `F12` ‡∏´‡∏£‡∏∑‡∏≠ `Ctrl+Shift+I`
   - ‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡πÅ‡∏ó‡πá‡∏ö **Application** ‡∏´‡∏£‡∏∑‡∏≠ **Storage**

2. **‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Session:**
   - ‡πÑ‡∏õ‡∏ó‡∏µ‡πà **Local Storage** ‚Üí `https://zkzjbhvsltbwbtteihiy.supabase.co`
   - ‡∏î‡∏π `sb-zkzjbhvsltbwbtteihiy-auth-token`
   - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ token ‡∏¢‡∏±‡∏á‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡∏∞‡πÑ‡∏°‡πà‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏

3. **‡∏•‡∏ö Session ‡πÅ‡∏•‡∏∞ Login ‡πÉ‡∏´‡∏°‡πà:**
   - ‡∏•‡∏ö token ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
   - Login ‡πÉ‡∏´‡∏°‡πà

### ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 4: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ Session Token ‡∏ñ‡∏π‡∏Å‡∏™‡πà‡∏á‡πÑ‡∏õ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á

1. **‡πÄ‡∏õ‡∏¥‡∏î Browser DevTools:**
   - ‡∏Å‡∏î `F12`
   - ‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡πÅ‡∏ó‡πá‡∏ö **Network**

2. **‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠:**
   - ‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤ Settings
   - ‡∏Ñ‡∏•‡∏¥‡∏Å "‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ EasySlip API"

3. **‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Request Headers:**
   - ‡∏´‡∏≤ request ‡πÑ‡∏õ‡∏ó‡∏µ‡πà `/functions/v1/verify-slip`
   - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ `Authorization` header ‡∏°‡∏µ‡∏Ñ‡πà‡∏≤
   - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ `apikey` header ‡∏°‡∏µ‡∏Ñ‡πà‡∏≤

---

## Checklist

### ‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö:
- [ ] ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Edge Function settings ‡πÉ‡∏ô Supabase Dashboard
- [ ] ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ "Require authentication" ‡∏õ‡∏¥‡∏î‡∏≠‡∏¢‡∏π‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
- [ ] ‡∏•‡∏≠‡∏á logout ‡πÅ‡∏•‡∏∞ login ‡πÉ‡∏´‡∏°‡πà
- [ ] ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ session token ‡∏¢‡∏±‡∏á‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ
- [ ] ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ request headers ‡∏ñ‡∏π‡∏Å‡∏™‡πà‡∏á‡πÑ‡∏õ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á

### ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:
- [ ] ‡∏õ‡∏¥‡∏î "Require authentication" (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
- [ ] Logout ‡πÅ‡∏•‡∏∞ login ‡πÉ‡∏´‡∏°‡πà
- [ ] ‡∏•‡∏ö session token ‡πÅ‡∏•‡∏∞ login ‡πÉ‡∏´‡∏°‡πà
- [ ] ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á

---

## ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏

‚ö†Ô∏è **‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç:**
- HTTP 401 ‡πÄ‡∏Å‡∏¥‡∏î‡∏à‡∏≤‡∏Å Supabase reject request ‡∏Å‡πà‡∏≠‡∏ô‡∏ñ‡∏∂‡∏á Edge Function code
- JWT token ‡∏î‡∏π‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡πÅ‡∏ï‡πà Supabase ‡∏≠‡∏≤‡∏à validate ‡πÅ‡∏•‡∏∞ reject
- ‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Edge Function settings ‡πÅ‡∏•‡∏∞ session token

üìù **‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ï‡πà‡∏≠‡πÑ‡∏õ:**
1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Edge Function settings ‡πÉ‡∏ô Dashboard
2. ‡∏•‡∏≠‡∏á logout ‡πÅ‡∏•‡∏∞ login ‡πÉ‡∏´‡∏°‡πà
3. ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á
4. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Logs ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤
