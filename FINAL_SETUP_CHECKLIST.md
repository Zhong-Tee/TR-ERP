# Checklist р╕кр╕╕р╕Фр╕Чр╣Йр╕▓р╕в: р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╣Бр╕ер╕░р╕Чр╕Фр╕кр╕нр╕Ър╕гр╕░р╕Ър╕Ъ

## тЬЕ р╕кр╕Цр╕▓р╕Щр╕░р╕Ыр╕▒р╕Ир╕Ир╕╕р╕Ър╕▒р╕Щ

- [x] Supabase Dashboard р╣Ар╕Вр╣Йр╕▓р╣Др╕Фр╣Йр╣Бр╕ер╣Йр╕з
- [x] Edge Function `verify-slip` Deploy р╕кр╕│р╣Ар╕гр╣Зр╕Ир╣Бр╕ер╣Йр╕з
- [x] `EASYSLIP_API_KEY` р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╣Бр╕ер╣Йр╕з
- [x] `SERVICE_ROLE_KEY` р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╣Бр╕ер╣Йр╕з
- [x] `SUPABASE_URL` р╣Др╕бр╣Ир╕Хр╣Йр╕нр╕Зр╕Хр╕▒р╣Йр╕З (Supabase р╕Ир╕▒р╕Фр╣Гр╕лр╣Йр╕нр╕▒р╕Хр╣Вр╕Щр╕бр╕▒р╕Хр╕┤)

---

## р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕кр╕╕р╕Фр╕Чр╣Йр╕▓р╕в: р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╣Бр╕ер╕░р╕Чр╕Фр╕кр╕нр╕Ъ

### 1. р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ Secrets р╕Чр╕╡р╣Ир╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╣Др╕зр╣Й

```powershell
# р╕Фр╕╣ secrets р╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Ф
supabase secrets list
```

**р╕Др╕зр╕гр╣Ар╕лр╣Зр╕Щ:**
- `EASYSLIP_API_KEY` тЬЕ
- `SERVICE_ROLE_KEY` тЬЕ

### 2. Deploy Edge Function р╣Гр╕лр╕бр╣И (р╕Цр╣Йр╕▓р╕вр╕▒р╕Зр╣Др╕бр╣Ир╣Др╕Фр╣Й Deploy р╕лр╕ер╕▒р╕Зр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓ Secrets)

```powershell
cd e:\Web_App\TR-ERP
supabase functions deploy verify-slip
```

**р╕лр╕бр╕▓р╕вр╣Ар╕лр╕Хр╕╕:** р╕Цр╣Йр╕▓ Deploy р╣Др╕Ыр╣Бр╕ер╣Йр╕зр╕Бр╣Ир╕нр╕Щр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓ Secrets р╕нр╕▓р╕Ир╕Хр╣Йр╕нр╕З Deploy р╣Гр╕лр╕бр╣Ир╣Ар╕Юр╕╖р╣Ир╕нр╣Гр╕лр╣Й function р╣Гр╕Кр╣Й Secrets р╕Чр╕╡р╣Ир╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╣Др╕зр╣Й

### 3. р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ Edge Function р╣Гр╕Щ Dashboard

1. **р╣Ар╕Вр╣Йр╕▓ Supabase Dashboard:**
   - р╣Др╕Ыр╕Чр╕╡р╣И https://supabase.com/dashboard/project/zkzjbhvsltbwbtteihiy/functions

2. **р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ function `verify-slip`:**
   - р╕Фр╕╣р╕зр╣Ир╕▓ function р╕нр╕вр╕╣р╣Ир╣Гр╕Щр╕кр╕Цр╕▓р╕Щр╕░ "Active"
   - р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ URL: `https://zkzjbhvsltbwbtteihiy.supabase.co/functions/v1/verify-slip`

### 4. р╕Чр╕Фр╕кр╕нр╕Ъ Edge Function

**р╕зр╕┤р╕Шр╕╡р╕Чр╕╡р╣И 1: р╕Чр╕Фр╕кр╕нр╕Ър╕Ир╕▓р╕Бр╣Бр╕нр╕Ыр╕Юр╕ер╕┤р╣Ар╕Др╕Кр╕▒р╕Щ**

1. **р╣Ар╕Ыр╕┤р╕Фр╣Бр╕нр╕Ыр╕Юр╕ер╕┤р╣Ар╕Др╕Кр╕▒р╕Щ:**
   - р╕гр╕▒р╕Щр╣Бр╕нр╕Ыр╕Юр╕ер╕┤р╣Ар╕Др╕Кр╕▒р╕Щ (р╕Цр╣Йр╕▓р╕вр╕▒р╕Зр╣Др╕бр╣Ир╣Др╕Фр╣Йр╕гр╕▒р╕Щ)

2. **р╕Чр╕Фр╕кр╕нр╕Ър╕нр╕▒р╕Ыр╣Вр╕лр╕ер╕Фр╕кр╕ер╕┤р╕Ы:**
   - р╣Др╕Ыр╕Чр╕╡р╣Ир╕лр╕Щр╣Йр╕▓ Order Form
   - р╕нр╕▒р╕Ыр╣Вр╕лр╕ер╕Фр╕кр╕ер╕┤р╕Ы
   - р╕Бр╕Фр╕Ыр╕╕р╣Ир╕б "р╕Ър╕▒р╕Щр╕Чр╕╢р╕Б (р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Др╕гр╕Ъ)" р╣Ар╕Юр╕╖р╣Ир╕нр╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕кр╕ер╕┤р╕Ы
   - р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓р╕Бр╕▓р╕гр╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕кр╕ер╕┤р╕Ыр╕Чр╕│р╕Зр╕▓р╕Щр╣Др╕Фр╣Й

**р╕зр╕┤р╕Шр╕╡р╕Чр╕╡р╣И 2: р╕Чр╕Фр╕кр╕нр╕Ър╕Фр╣Йр╕зр╕в Script**

```powershell
# р╣Гр╕Кр╣Й test script р╕Чр╕╡р╣Ир╕бр╕╡р╕нр╕вр╕╣р╣И
node test-verify-slip.js
```

### 5. р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ Logs

1. **р╕Фр╕╣ Logs р╣Гр╕Щ Dashboard:**
   - р╣Др╕Ыр╕Чр╕╡р╣И Edge Functions тЖТ verify-slip тЖТ Logs
   - р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓р╣Др╕бр╣Ир╕бр╕╡ errors
   - р╕Фр╕╣ logs р╕зр╣Ир╕▓р╕бр╕╡р╕Бр╕▓р╕гр╣Ар╕гр╕╡р╕вр╕Бр╣Гр╕Кр╣Й function р╕лр╕гр╕╖р╕нр╣Др╕бр╣И

2. **р╕Фр╕╣ Logs р╕Фр╣Йр╕зр╕в CLI:**
   ```powershell
   supabase functions logs verify-slip
   ```

---

## Checklist р╕кр╕╕р╕Фр╕Чр╣Йр╕▓р╕в

### р╕Бр╕▓р╕гр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓:
- [x] Edge Function `verify-slip` Deploy р╕кр╕│р╣Ар╕гр╣Зр╕И
- [x] `EASYSLIP_API_KEY` р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╣Бр╕ер╣Йр╕з
- [x] `SERVICE_ROLE_KEY` р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╣Бр╕ер╣Йр╕з
- [ ] р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ Secrets (`supabase secrets list`)
- [ ] Deploy function р╣Гр╕лр╕бр╣И (р╕Цр╣Йр╕▓р╕Ир╕│р╣Ар╕Ыр╣Зр╕Щ)

### р╕Бр╕▓р╕гр╕Чр╕Фр╕кр╕нр╕Ъ:
- [ ] р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ Edge Function р╣Гр╕Щ Dashboard
- [ ] р╕Чр╕Фр╕кр╕нр╕Ър╕нр╕▒р╕Ыр╣Вр╕лр╕ер╕Фр╕кр╕ер╕┤р╕Ыр╕Ир╕▓р╕Бр╣Бр╕нр╕Ыр╕Юр╕ер╕┤р╣Ар╕Др╕Кр╕▒р╕Щ
- [ ] р╕Чр╕Фр╕кр╕нр╕Ър╕Бр╕▓р╕гр╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕кр╕ер╕┤р╕Ы
- [ ] р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ Logs р╣Др╕бр╣Ир╕бр╕╡ errors

### р╕Бр╕▓р╕гр╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣М:
- [ ] р╕кр╕ер╕┤р╕Ыр╕нр╕▒р╕Ыр╣Вр╕лр╕ер╕Фр╣Др╕Фр╣Й
- [ ] р╕Бр╕▓р╕гр╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕кр╕ер╕┤р╕Ыр╕Чр╕│р╕Зр╕▓р╕Щр╣Др╕Фр╣Й
- [ ] р╕Ьр╕ер╕Бр╕▓р╕гр╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Цр╕╣р╕Бр╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╕ер╕Зр╕Рр╕▓р╕Щр╕Вр╣Йр╕нр╕бр╕╣р╕е
- [ ] р╕кр╕Цр╕▓р╕Щр╕░р╕Ър╕┤р╕ер╕нр╕▒р╕Ыр╣Ар╕Фр╕Хр╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕З

---

## Troubleshooting

### р╕Ыр╕▒р╕Нр╕лр╕▓: Edge Function р╣Др╕бр╣Ир╕Чр╕│р╕Зр╕▓р╕Щ

**р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ:**
1. Secrets р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕Зр╕лр╕гр╕╖р╕нр╣Др╕бр╣И (`supabase secrets list`)
2. Function Deploy р╕кр╕│р╣Ар╕гр╣Зр╕Ир╕лр╕гр╕╖р╕нр╣Др╕бр╣И
3. Logs р╕бр╕╡ errors р╕лр╕гр╕╖р╕нр╣Др╕бр╣И

**р╕зр╕┤р╕Шр╕╡р╣Бр╕Бр╣Й:**
- р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ Secrets р╕нр╕╡р╕Бр╕Др╕гр╕▒р╣Йр╕З
- Deploy function р╣Гр╕лр╕бр╣И
- р╕Фр╕╣ Logs р╣Ар╕Юр╕╖р╣Ир╕нр╕лр╕▓р╕кр╕▓р╣Ар╕лр╕Хр╕╕

### р╕Ыр╕▒р╕Нр╕лр╕▓: HTTP 401 Unauthorized

**р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ:**
1. `SERVICE_ROLE_KEY` р╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕Зр╕лр╕гр╕╖р╕нр╣Др╕бр╣И
2. Session token р╕лр╕бр╕Фр╕нр╕▓р╕вр╕╕р╕лр╕гр╕╖р╕нр╣Др╕бр╣И

**р╕зр╕┤р╕Шр╕╡р╣Бр╕Бр╣Й:**
- р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ `SERVICE_ROLE_KEY` р╕нр╕╡р╕Бр╕Др╕гр╕▒р╣Йр╕З
- р╕ер╕нр╕З logout р╣Бр╕ер╕░ login р╣Гр╕лр╕бр╣Ир╣Гр╕Щр╣Бр╕нр╕Ы

### р╕Ыр╕▒р╕Нр╕лр╕▓: EasySlip API р╣Др╕бр╣Ир╕Чр╕│р╕Зр╕▓р╕Щ

**р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ:**
1. `EASYSLIP_API_KEY` р╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕Зр╕лр╕гр╕╖р╕нр╣Др╕бр╣И
2. EasySlip service р╣Ар╕Ыр╕┤р╕Фр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╕лр╕гр╕╖р╕нр╣Др╕бр╣И

**р╕зр╕┤р╕Шр╕╡р╣Бр╕Бр╣Й:**
- р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ `EASYSLIP_API_KEY` р╕нр╕╡р╕Бр╕Др╕гр╕▒р╣Йр╕З
- р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓ EasySlip service р╣Ар╕Ыр╕┤р╕Фр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╣Бр╕ер╣Йр╕з

---

## р╕лр╕бр╕▓р╕вр╣Ар╕лр╕Хр╕╕

тЬЕ **р╕кр╕│р╣Ар╕гр╣Зр╕Ир╣Бр╕ер╣Йр╕з:**
- р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓ Secrets р╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Фр╣Ар╕кр╕гр╣Зр╕Ир╣Бр╕ер╣Йр╕з
- Edge Function Deploy р╕кр╕│р╣Ар╕гр╣Зр╕Ир╣Бр╕ер╣Йр╕з

ЁЯУЭ **р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Хр╣Ир╕нр╣Др╕Ы:**
1. р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ Secrets
2. р╕Чр╕Фр╕кр╕нр╕Ър╕гр╕░р╕Ър╕Ъ
3. р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ Logs
4. р╣Бр╕Бр╣Йр╣Др╕Вр╕Ыр╕▒р╕Нр╕лр╕▓р╕Чр╕╡р╣Ир╕Юр╕Ъ (р╕Цр╣Йр╕▓р╕бр╕╡)

---

## р╕Др╕│р╕Цр╕▓р╕бр╕Чр╕╡р╣Ир╕Юр╕Ър╕Ър╣Ир╕нр╕в

### Q: р╕Хр╣Йр╕нр╕З Deploy function р╣Гр╕лр╕бр╣Ир╕лр╕ер╕▒р╕Зр╕Ир╕▓р╕Бр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓ Secrets р╕лр╕гр╕╖р╕нр╣Др╕бр╣И?
**A:** 
- р╕Цр╣Йр╕▓ Deploy р╣Др╕Ыр╣Бр╕ер╣Йр╕зр╕Бр╣Ир╕нр╕Щр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓ Secrets р╕нр╕▓р╕Ир╕Хр╣Йр╕нр╕З Deploy р╣Гр╕лр╕бр╣И
- р╣Бр╕Хр╣Ир╣Вр╕Фр╕вр╕Ыр╕Бр╕Хр╕┤ Supabase р╕Ир╕░р╣Гр╕Кр╣Й Secrets р╕Чр╕╡р╣Ир╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╣Др╕зр╣Йр╕Чр╕▒р╕Щр╕Чр╕╡

### Q: р╕Ир╕░р╕гр╕╣р╣Йр╣Др╕Фр╣Йр╕нр╕вр╣Ир╕▓р╕Зр╣Др╕гр╕зр╣Ир╕▓р╕гр╕░р╕Ър╕Ър╕Чр╕│р╕Зр╕▓р╕Щр╣Др╕Фр╣Й?
**A:**
- р╕Чр╕Фр╕кр╕нр╕Ър╕нр╕▒р╕Ыр╣Вр╕лр╕ер╕Фр╕кр╕ер╕┤р╕Ыр╣Бр╕ер╕░р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ
- р╕Фр╕╣ Logs р╕зр╣Ир╕▓р╣Др╕бр╣Ир╕бр╕╡ errors
- р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓р╕Ьр╕ер╕Бр╕▓р╕гр╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Цр╕╣р╕Бр╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╕ер╕Зр╕Рр╕▓р╕Щр╕Вр╣Йр╕нр╕бр╕╣р╕е

### Q: р╕Цр╣Йр╕▓р╕бр╕╡р╕Ыр╕▒р╕Нр╕лр╕▓р╣Гр╕лр╣Йр╕Чр╕│р╕нр╕вр╣Ир╕▓р╕Зр╣Др╕г?
**A:**
- р╕Фр╕╣ Logs р╣Гр╕Щ Dashboard
- р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ Secrets р╕нр╕╡р╕Бр╕Др╕гр╕▒р╣Йр╕З
- р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓ EasySlip service р╣Ар╕Ыр╕┤р╕Фр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╣Бр╕ер╣Йр╕з
